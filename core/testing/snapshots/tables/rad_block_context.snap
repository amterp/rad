### TITLE ###
RadBlock_MapContext_PrintFullContext
### INPUT ###
nums = [10, 20, 30]
display:
	fields nums
	nums:
		map fn(x, ctx) ctx
### STDOUT ###
nums                                                 
{ "idx": 0, "src": [ 10, 20, 30 ], "field": "nums" }  
{ "idx": 1, "src": [ 10, 20, 30 ], "field": "nums" }  
{ "idx": 2, "src": [ 10, 20, 30 ], "field": "nums" }  

### TITLE ###
RadBlock_MapContext_Src
### INPUT ###
nums = [10, 20, 30]
display:
	fields nums
	nums:
		map fn(x, ctx) "{x} of {ctx.src.len()}"
### STDOUT ###
nums    
10 of 3  
20 of 3  
30 of 3  

### TITLE ###
RadBlock_MapContext_SingleParamStillWorks
### INPUT ###
nums = [10, 20, 30]
display:
	fields nums
	nums:
		map fn(x) x * 2
### STDOUT ###
nums 
20    
40    
60    

### TITLE ###
RadBlock_FilterContext_Idx
### INPUT ###
nums = [10, 20, 30, 40, 50]
display:
	fields nums
	nums:
		filter fn(x, ctx) ctx.idx % 2 == 0
### STDOUT ###
nums 
10    
30    
50    

### TITLE ###
RadBlock_FilterContext_Src
### INPUT ###
nums = [10, 20, 30, 40, 50]
display:
	fields nums
	nums:
		filter fn(x, ctx) x < sum(ctx.src) / ctx.src.len()
### STDOUT ###
nums 
10    
20    

### TITLE ###
RadBlock_MapContext_MultipleFields
### INPUT ###
col1 = [1, 2]
col2 = [10, 20]
display:
	fields col1, col2
	col1, col2:
		map fn(x, ctx) "{ctx.field}={x}"
### STDOUT ###
col1    col2    
col1=1  col2=10  
col1=2  col2=20  

### TITLE ###
RadBlock_MapContext_WithFilter
### INPUT ###
nums = [10, 20, 30, 40]
display:
	fields nums
	nums:
		filter fn(x) x > 15
		map fn(x, ctx) "{ctx.idx}: {x}"
### STDOUT ###
nums  
0: 20  
1: 30  
2: 40  

### TITLE ###
RadBlock_MapContext_SrcIsImmutableSnapshot
### INPUT ###
fn mutate_and_return(x, ctx):
	ctx.src[0] = 999
	return x

nums = [10, 20, 30]
display:
	fields nums
	nums:
		map mutate_and_return
print(nums)
### STDOUT ###
nums 
10    
20    
30    
[ 10, 20, 30 ]

### TITLE ###
RadBlock_FilterContext_SrcIsImmutableSnapshot
### INPUT ###
fn mutate_and_keep(x, ctx):
	ctx.src[0] = 999
	return true

nums = [10, 20, 30]
display:
	fields nums
	nums:
		filter mutate_and_keep
print(nums)
### STDOUT ###
nums 
10    
20    
30    
[ 10, 20, 30 ]

